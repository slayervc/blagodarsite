# Проект бонусной системы

### Информация о проекте

Сайт представляет из себя обертку над API ядра на основе 1C Bitrix.

От сайта требуется:

* хранить данные о пользователях
* использовать функционал API из программного интерфейса
* показывать рекламу (после основного функционала)


### Готовность

* Есть верстка, интегрированна в шаблон (могут понадобятся доработки для функционала)
* Форма регистрации: 1. Производит запросы к API ядра бонусной системы. 2. Добавляет пользователя в БД сайта (нужна доработка)
* Форма авторизации -- нужна доработка по изменению пользователя (изменения пароля в БД сайта)
* Кабинет клиента -- добавить сверстанную страницу для клиента
* Кабинет партнера -- добавить сверстанную страницу для партнера, добавить функционал для списания


### Алгоритм работы регистрации, авторизации

1. Пользователь делает ajax запрос на сайт, с сайта делается запрос для получения кода регистрации нового пользователя
2. Пользователь вводит персональные данные и код регистрации
3. Сайт делает запрос к API для регистрации
4. Если API возвращает положительные ответ, то данные заносятся в БД сайта, а пользователю отправляется смс с логином и паролем, если API возвращает ошибку, пользователю выводятся сообщения об ошибке
5. Пользователь вводит данные для авторизации
6. Сайт делает запрос к API
7. Если ответ положительный в БД сайта проводится замена пароля пользователя, после чего пользователя авторизует Bitrix, а пароль помещается в сессию для дальнейших запросов
8. На странице пользователя выводятся данные из API

### Разделение работы

1. Работа с API ядра бонусной системы
2. Работа над дополнительным функционалом на страницах (Поиск по компаниям партнеров, Лучшие предложения, Акции, Новости)
3. Дополнительные страницы (Каталог предприятий, Акции, Рекомендации, Новости, О Программе, Контакты) *нету информации*


### Установка и настройка

1. Установить битрикс
2. Выполнить ```composer install```


### Сроки

Запустить основной функционал в начале Февраля


### Работа с API бонусной системы

Ссылки:

1. [Api для клиента | партнера](http://docs.clientapi12.apiary.io/)
2. [Api для административных функций](http://docs.system1.apiary.io/)

Чтобы получить **TOKEN передаваемый сайту** для того чтобы совершать запросы надо написать мне в скайп

Лучше всего пользоваться классами 1c-bitrix для получения таких данных из файла *.settings_extra.php* (Для авторизации и регистрации уже есть обработка через такой класс, можно посмотреть в ветке master)

Для работы с каталогами компаний следует изучить вторую ссылку.

Вопросы по функционалу обговорить.

### По API (Предложение или какой функционал надо доработать):

* Проверка обновления суммы по бонусам




